{"version":3,"file":"static/js/app.af2528acf28ba1d6eea9.js","sources":["webpack:///./src/services/fetch.js"],"sourcesContent":["import axios from 'axios'\nimport { Message, MessageBox } from 'element-ui'\nimport router from '@/router'\nimport store from '@/store'\n\nlet paramsSerializer = function (params) {\n  let parts = [];\n  for (let key in params) {\n    let val = params[key]\n    if (val === null || typeof val === 'undefined') {\n      continue;\n    }\n    if (Array.isArray(val)) {\n      val = JSON.stringify(val)\n    }\n    parts.push(encodeURIComponent(key) + '=' + encodeURIComponent(val));\n  }\n  let result = parts.join('&');\n  return result\n}\naxios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded'\nlet instance = axios.create({\n  baseURL: '/api',\n  // timeout: 600000,\n  timeout: 30000,\n  paramsSerializer: function (params) {\n    return paramsSerializer(params)\n  }\n});\nlet paramPost = function (data) {\n  var params = new URLSearchParams();\n  for (let name in data) {\n    params.append(name, data[name]);\n  }\n  return params\n}\n// 登录过期处理\nlet is_show_login_missing = false;\n\ninstance.interceptors.response.use(res => {\n  let result = res.data;\n  if ( result.ret == -1  && !is_show_login_missing) {\n    is_show_login_missing = true\n    MessageBox({\n      title: '提示',\n      message: '登录信息过期',\n      confirmButtonText: '确定',\n      callback: action => {\n        store.dispatch('user/remove_login_info')\n          .then( ()=> {\n            is_show_login_missing = false\n            router.push('/login')\n          })\n      }\n    })\n  }\n  return result;\n})\nexport default instance\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/fetch.js"],"mappings":"AAoBA","sourceRoot":""}